import{createApp}from "vue";import{fetchCsrfToken}from "common"
createApp({data(){return{bucket_list:[],input_name:"",input_description:"",error:false,csrf_token:""}},methods:{csrfToken(){fetchCsrfToken().then(token=>this.csrf_token=token);},getBucketList(){fetch('/bucket-list/all').then(res=>res.json()).then(data=>{this.bucket_list=data;this.formatDate();});},formatDate(){this.bucket_list.forEach(item=>{item.timestamp=new Date(item.timestamp).toLocaleString();});},addToBucketList(){let json={name:this.input_name,description:this.input_description}
let token=this.csrf_token;fetch('/bucket-list/add',{method:'POST',headers:{'Content-Type':'application/json','X-Csrf-Token':token,},body:JSON.stringify(json)}).then(res=>{this.csrfToken();if(res.status===201){this.getBucketList();this.input_name="";this.input_description="";this.error=false;}else if(res.status===422){let content=res.json();content.then(data=>{this.error=data;});}})}},mounted(){this.getBucketList();this.csrfToken();},}).mount('#bucket-list');