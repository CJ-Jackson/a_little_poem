import{createApp}from"vue";import{fetchCsrfToken}from"common";createApp({data(){return{bucket_list:[],input_name:"",input_description:"",error:!1,csrf_token:""}},methods:{csrfToken(){fetchCsrfToken().then(e=>this.csrf_token=e)},getBucketList(){fetch("/bucket-list/all").then(e=>e.json()).then(e=>{this.bucket_list=e,this.formatDate()})},formatDate(){this.bucket_list.forEach(e=>{e.timestamp=new Date(e.timestamp).toLocaleString()})},addToBucketList(){let e={name:this.input_name,description:this.input_description},t=this.csrf_token;fetch("/bucket-list/add",{method:"POST",headers:{"Content-Type":"application/json","X-Csrf-Token":t},body:JSON.stringify(e)}).then(e=>{if(this.csrfToken(),e.status===201)this.getBucketList(),this.input_name="",this.input_description="",this.error=!1;else if(e.status===422){let t=e.json();t.then(e=>{let t={};for(let n in e)t[e[n].field_name]=e[n].messages;this.error=t})}})}},mounted(){this.getBucketList(),this.csrfToken()}}).mount("#bucket-list")